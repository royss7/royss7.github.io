---
layout: post
categories: Programming
tags: Programming
title: "Book of clean code"
description: What's dirty code and how to write clean code
---

- Later equals never. 发现问题马上修正而不是拖着。
- 整洁的代码看起來就是特別在意的人寫的。
- 命名：
  1. 名副其實：變量名有意义
  2. 避免误导：专用词汇尽量不要用，比如hp/linux等；accountList这种不要用，即使真的存储在list中，可以用accountGroup甚至直接accounts；不要用大小写做区分，比如xYZ和XyZ；命名保持一致，即不要前后用不同的词汇表示相同的概念。不要单独用小写字母l和大写O做变量名，尤其不要混用，比如lO和1O，根本分不清楚。
  3. 减少废话：无意义的命名，比如a1,a2这种；Product和ProductData/ProductInfo，后两者Data和Info没有任何意义。
  4. 使用读得出的名称：尽量减少简化词，现代IDE都有补全功能，简化词不能带来任何效益。比如TimeStamp简化成TS。
  5. 专业的程序员了解，明确是王道。专业的程序员善用其能，编写他人能够明白的代码。
- 函数：
  1. 函数的第一规则要短小，第二规则**还要更短小**。
  2. 函数应该做一件事。做好这件事，只做这一件事。
  3. 标识参数丑陋不堪。**向函数传入bool简直是骇人听闻的做法**。这样做，方法签名立刻变的复杂起来，大声宣布本函数不止做了一件事。如果标识为true会这样做，标识为false会那样做。
  4. 函数参数越少越好，最好0个，其次1个，再次2个，不要多于2个（虽然不可能）。
  5. 函数应该只做一见，try/catch就是一件事。因此，try如果在某个函数中，那么它应该在第一行的第一个单词，而且catch/finally之后不应该有内容。
  6. 写代码和写东西很像，刚开始写出来也许很丑陋。后面不断重构，分解函数，修改名称，消除重复，缩短重新安置方法。遵循一些规则，最终才能达到心目中的样子。
- 注释
  1. **我为什么极力贬低注释？因为注释会撒谎!!**
  2. 只有代码是真实的，是唯一准确的信息来源。
  3. 注释不能美化糟糕的代码。不如花时间清洁那些丑陋的代码。
  4. changlog不应该出现在代码注释中，代码管理工具可以很好的完成这件事。
  5. 能用函数或者变量时就别用注释。用代码说话。
  6. 归属和署名也不要加在注释中，随着时间的增加，源码和作者信息会越来越不符，请用代码管理工具来完成这件事。
  7. **直接把代码注释掉时很讨厌的做法。别这么干！！！**
  8. 短函数不要太多的描述。请为函数取个好名字来完成注释。
- 格式
  1. 调用函数在上面，被调用函数在下面。
  2. c++遵循方法在前面，变量在后面；java遵循方法在后面，变量在前面。
  3. 像报纸一样，方法应该简短，而不是长篇大论，文件也是（最好不超过200行）。
  4. 程序员更喜欢短代码行。最好不需要滚动滑动条就可以读完一行。
  5. 不要对齐声明和赋值，没什么用，除了分散注意力。
- 错误处理
  1. 别返回null值。用exception代替，或者返回相应的空值，比如空的list等。
  2. 别传递null值。
- 单元测试
  1. TDD三定律
    - 在编写不能通过的单元测试前，不可编写声唱代码。
    - 只可编写刚好无法通过的单元测试，不能编译也算不能通过。
    - 只编写刚好足以通过当前失败测试的生产代码。
    测试与生产代码一起编写，测试只比生产代码早几秒。
  2. 保持测试的整洁。用生产代码相同的要求去写测试代码。
  3. **测试带来一切好处**,有了测试，你就不必担心对代码的修改。没有测试，每次修改都可能带来缺陷。
  4. 整洁的测试要三个要求：可读性，可读性和可读性。
  5. 每个测试都应该清晰的拆分成三个环节：构造（build）-操作（operate）-检验（check）。
  6. 每个测试函数有且仅有1个断言。
- 类
  1. 类应该短小，像函数一样。类名可以描述其职责，需要的描述越多说明类的职责越大，越不可取。
  2. 让软件能工作和让软件保持简洁，是截然不同的工作。我们汇总的大多数人脑力有限，只能把更多精力放在让代码能工作上。问题是太多人以为代码能工作就完事大吉了。
  3. 系统应该有许多短小的类而不是由少量巨大的类组成。每个小类封装成一个权责，只有一个修改原因，并与少数其它类一起协同达成期望的系统行为。
- 迭进
  1. Kent Beck简单设计4规则：
    - 运行所有测试
    - 不可重复
    - 表达了程序员的意图
    - 尽可能的减少类和方法的数量（？？？）
    - 以上规则按其重要程度排列
  2. 不可测试的系统同样不可验证。不可验证的系统，绝不可部署。
  3. 软件项目的主要成本在于长期维护。为了修改时尽可能的降低出现缺陷的可能性，很有必要理解系统是做什么的。当系统变得越来越复杂，开发者就需要越来越多的时间来理解它，而且极有可能发生误解。
- 味道和启发
  1. 注释：
    - 不恰当的信息，比如注释中包含应该由版本管理的信息（作者，最后修改时间等）
    - 废弃的注释，过时，无关或者不正确的注释就是废弃的注释
    - 冗余的注释
    - 糟糕的注释
    - 注释掉的代码
  2. 函数
    - 过多的参数
    - 输出参数
    - 标识参数
    - 死函数，永不被调用的函数应该被丢弃。
  3. 一般性问题
    - 一个源文件中存在多种语言
    - 明显的行为未被实现
    - 不正确的边界行为
    - 忽视安全
    - **重复**
    - 基类依赖于派生类
    - 信息过多
    - 前后不一致
    - 选择算子，boolean参数等
    - 否定性条件，使用肯定式要比否定式更好理解。
  4. 名称
    - 请采用描述性名称。
    - 尽可能的使用标准命名法
    - 无歧义的名称
  5. 测试
    - 测试不足
    - 请使用覆盖率工具
    - 请别忽略小测试
    - 测试应该快速
  